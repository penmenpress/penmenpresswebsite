/*
Part of the WordPress plugin Tag Groups
Plugin URI: https://chattymango.com/tag-groups/
Author: Christoph Amthor
License: GNU GENERAL PUBLIC LICENSE, Version 3
Last modified: 20190510
Created with: https://jscompress.com/
*/

function tg_do_ajax(b,y,m){var t={action:"tg_ajax_manage_groups",nonce:jQuery("#tg_nonce").val()};jQuery.extend(y,t),y.start_position=jQuery("#tg_start_position").val();var v="";jQuery.ajax({url:b.ajaxurl,data:y,dataType:"text",method:"post",success:function(t){try{var a=JSON.parse(t)}catch(t){v='<div class="notice notice-error"><p>Error loading groups. Please check <b>Tag Groups Settings -> Troubleshooting -> System Information -> Ajax Test</b></p></div><br clear="all" />',jQuery("#tg_message_container").fadeTo(200,0,function(){jQuery(this).html(v).fadeTo(400,1)})}var s=a.data,e=a.supplemental.message,n=a.supplemental.nonce;a.supplemental.task;if(""!==n&&jQuery("#tg_nonce").val(n),"success"===s){var o=a.supplemental.groups,l=a.supplemental.start_position;""!==l?jQuery("#tg_start_position").val(l):l=y.start_position;a.supplemental.end_position;var r=a.supplemental.max_number,d="",p=l;if(0<r)for(var c in o){var _=o[c];null!=_.id&&(d+='<tr class="tg_sort_tr" data-position="'+p+'">\n',d+="<td>"+_.id+"</td>\n",d+='<td class="tg_label_column"><span class="tg_edit_label tg_text" data-position="'+p+'" data-label="'+escape_html(_.label)+'">'+escape_html(_.label)+'<span class="dashicons dashicons-edit tg_pointer" style="display:none;"></span></span></td>\n',d+='<td class="tg_hide_when_drag"><div class="tg_term_amounts">',""!==b.tagsurl?d+='<a href="'+b.tagsurl+"&term-filter="+_.id+'" title="'+m.tooltip_showtags+'">'+_.amount+"</a>":d+=_.amount+"</span>",d+="</div>",d+='</td>\n<td class="tg_hide_when_drag">',""!==b.tagsurl&&(d+='<a href="'+b.tagsurl+"&term-filter="+_.id+'" title="'+m.tooltip_showtags+'"><span class="tg_pointer dashicons dashicons-tag"></span></a> '),""!==b.postsurl&&(d+='<a href="'+b.postsurl+"&post_status=all&tg_filter_posts_value="+_.id+'" title="'+m.tooltip_showposts+'"><span class="tg_pointer dashicons dashicons-admin-page"></span></a>'),d+='</td>\n<td class="tg_hide_when_drag">',d+='<span class="tg_delete tg_pointer dashicons dashicons-trash" data-position="'+p+'" title="'+m.tooltip_delete+'"></span>',d+='<span class="tg_pointer dashicons dashicons-plus-alt" title="'+m.tooltip_newbelow+'" onclick="tg_toggle_clear('+p+')" style="margin-left:5px;"></span>',d+="</td>\n",d+='<td class="tg_hide_when_drag">',d+='<div style="overflow:hidden; position:relative; height:20px; clear:both;">',1<p&&(d+='<span class="tg_up tg_pointer dashicons dashicons-arrow-up" data-position="'+p+'" title="'+m.tooltip_move_up+'""></span>'),d+="</div>",d+='<div style="overflow:hidden; position:relative; height:20px; clear:both;">',p<r&&(d+='<span class="tg_down tg_pointer dashicons dashicons-arrow-down" data-position="'+p+'" title="'+m.tooltip_move_down+'"></span>'),d+="</div>",d+="</td>\n",d+="</tr>\n",d+='<tr class="tg_new_group_row" style="display:none;" id="tg_new_'+p+'">\n',d+='<td style="display:none;">'+m.newgroup+"</td>\n",d+='<td colspan="5" style="display:none;"><input data-position="'+p+'"  placeholder="'+m.placeholder_new+'">',d+='<span class="tg_new_yes dashicons dashicons-yes tg_pointer" data-position="'+p+'"></span> <span class="tg_new_no dashicons dashicons-no-alt tg_pointer" data-position="'+p+'" onclick="tg_toggle_clear('+p+')"></span>',d+="</td>\n",d+="</tr>\n",p++)}else d+='<tr id="tg_new_1">\n',d+="<td ></td>\n",d+='<td colspan="4"><input data-position="0" placeholder="'+m.newgroup+'">',d+='<span class="tg_new_yes dashicons dashicons-yes tg_pointer" data-id="1"></span></span>',d+="</td>\n",d+="</tr>\n";jQuery("#tg_groups_container").html(d);var g,u,h="",f=Number(b.items_per_page);for(f<1&&(f=1),u=Math.floor(l/f)+1,max_page=Math.floor((r-1)/f)+1,h+=1<u?'<button class="button-secondary tg_pager_button" data-page="'+(u-1)+'"><span class="dashicons dashicons-arrow-left-alt2"></span></button>':'<button class="button-secondary tg_pager_button" disabled><span class="dashicons dashicons-arrow-left-alt2"></span></button>',i=1;i<=r;i+=f)g=Math.floor(i/f)+1,h+=g==u?'<button class="tg_reload_button tg_pointer button-secondary" id="tg_groups_reload" title="'+m.tooltip_reload+'"><span class="dashicons dashicons-update"></span></button>':'<button class="button-secondary tg_pager_button" data-page="'+g+'"><span>'+g+"</span></button>";u<max_page?h+='<button class="button-secondary tg_pager_button" data-page="'+(u+1)+'"><span class="dashicons dashicons-arrow-right-alt2"></span></button>':h+='<button class="button-secondary tg_pager_button" disabled><span class="dashicons dashicons-arrow-right-alt2"></span></button>',jQuery("#tg_pager_container").fadeOut(200,function(){jQuery(this).html(h).fadeIn(400,function(){jQuery("#tg_pager_container_adjuster").css({height:Number(jQuery("#tg_pager_container").height())+10})})}),v+=""!=e?'<div class="notice notice-success"><p>'+e+'</p></div><br clear="all" />':'<div><p>&nbsp;</p></div><br clear="all" />',jQuery("#tg_message_container").fadeTo(200,0,function(){jQuery(this).html(v).fadeTo(400,1)})}else""==e&&(e="Error loading data.",console.log(t)),v+='<div class="notice notice-error"><p>'+e+'</p></div><br clear="all" />',jQuery("#tg_message_container").fadeTo(200,0,function(){jQuery(this).html(v).fadeTo(400,1)})},error:function(t,a,s){console.log("[Tag Groups] error: "+t.responseText)}})}function tg_close_textfield(t,a){var s,e=t.children(":first").attr("data-position");s=escape_html(a?t.children(":first").attr("value"):t.children(":first").attr("data-label")),t.replaceWith('<span class="tg_edit_label tg_text" data-position="'+e+'" data-label="'+s+'">'+s+' <span class="dashicons dashicons-edit tg_pointer" style="display:none;"></span></span>')}function tg_toggle_clear(t){var a=jQuery("#tg_new_"+t);a.is(":visible")?(jQuery("[data-position="+t+"]").val(""),a.children().fadeOut(300,function(){a.slideUp(600)})):(jQuery('[id^="tg_new_"]:visible').children().fadeOut(300,function(){jQuery('[id^="tg_new_"]:visible').slideUp(400)}),a.delay(200).slideDown(400,function(){a.children().fadeIn(300),jQuery("[data-position="+t+"]").focus()}))}function tg_close_all_textfields(){jQuery(".tg_edit_label_active").each(function(){tg_close_textfield(jQuery(this),!1)})}function escape_html(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}
